<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>芯片选择界面</title>
    <style>
        /* 设置主容器为 20x20 厘米 */
        .board {
            width: 200mm;
            height: 200mm;
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 10px;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid #ccc;
        }

        /* 芯片按钮样式 */
        .chip {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
            border: 1px solid #aaa;
            cursor: pointer;
            user-select: none;
        }

        .chip.selected {
            background-color: #4CAF50;
            color: white;
        }

        /* 输入框和按钮样式 */
        #serialNumber, #submitButton {
            margin: 10px;
            padding: 8px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>芯片选择界面</h1>
    <input type="text" id="serialNumber" placeholder="请输入序列号" />
    <button id="submitButton">完成选择</button>
    <div class="board" id="board"></div>

    <script>
        // 从 URL 中获取序列号参数
        const urlParams = new URLSearchParams(window.location.search);
        const serialNumber = urlParams.get('sn'); // 获取 URL 中的序列号参数

        // 如果存在序列号参数，将其填入输入框
        if (serialNumber) {
            document.getElementById("serialNumber").value = serialNumber;
        }

        // 芯片数量和位号列表
        const chips = Array.from({ length: 50 }, (_, i) => `U${i + 1}`);
        const selectedChips = [];

        // 创建芯片按钮并添加到板子上
        const board = document.getElementById("board");
        chips.forEach(chipId => {
            const chip = document.createElement("div");
            chip.className = "chip";
            chip.textContent = chipId;

            // 点击事件，用于选择和取消选择
            chip.addEventListener("click", () => {
                if (selectedChips.includes(chipId)) {
                    selectedChips.splice(selectedChips.indexOf(chipId), 1);
                    chip.classList.remove("selected");
                } else {
                    selectedChips.push(chipId);
                    chip.classList.add("selected");
                }
                console.log("已选择芯片位号:", selectedChips);
            });

            board.appendChild(chip);
        });

        // 点击完成选择按钮，显示已选择的芯片位号
        document.getElementById("submitButton").addEventListener("click", () => {
            const serialNumber = document.getElementById("serialNumber").value;
            if (!serialNumber) {
                alert("请先输入序列号！");
                return;
            }
            if (selectedChips.length === 0) {
                alert("请先选择至少一个芯片！");
                return;
            }

            // 显示选择结果（此处不发送 API）
            alert(`序列号: ${serialNumber}\n已选择芯片位号: ${selectedChips.join(", ")}`);
            console.log("提交内容:", { serialNumber, selectedChips });
        });
    </script>
</body>
</html>
