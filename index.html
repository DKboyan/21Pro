<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>芯片选择界面</title>
    <style>
        .board {
            width: 200mm;
            height: 200mm;
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 10px;
            padding: 20px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid #ccc;
        }
        .chip {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f0f0f0;
            border: 1px solid #aaa;
            cursor: pointer;
            user-select: none;
        }
        .chip.selected {
            background-color: #4CAF50;
            color: white;
        }
        #submitButton {
            margin: 10px;
            padding: 8px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <h1>芯片选择界面</h1>
    <button id="submitButton">完成选择</button>
    <div class="board" id="board"></div>

    <script>
        const chips = Array.from({ length: 50 }, (_, i) => `U${i + 1}`);
        let selectedChips = [];

        const board = document.getElementById("board");
        chips.forEach(chipId => {
            const chip = document.createElement("div");
            chip.className = "chip";
            chip.textContent = chipId;

            // 点击事件用于选择和取消选择芯片
            chip.addEventListener("click", () => {
                if (selectedChips.includes(chipId)) {
                    selectedChips.splice(selectedChips.indexOf(chipId), 1);
                    chip.classList.remove("selected");
                } else {
                    selectedChips.push(chipId);
                    chip.classList.add("selected");
                }
                console.log("已选择芯片位号:", selectedChips);
            });

            board.appendChild(chip);
        });

        // 点击“完成选择”按钮的事件处理
        document.getElementById("submitButton").addEventListener("click", () => {
            if (selectedChips.length === 0) {
                alert("请先选择至少一个芯片！");
                return;
            }

            const chipList = selectedChips.join(", ");
            navigator.clipboard.writeText(chipList).then(() => {
                alert(`已选择芯片位号: ${chipList}\n\n芯片位号已复制到剪贴板，您可以在简道云表单中粘贴。`);
                resetSelection(); // 重置选择状态
            }).catch(err => {
                console.error('复制失败:', err);
                alert(`无法复制到剪贴板，请手动复制芯片位号：\n${chipList}`);
                resetSelection(); // 即使失败也重置选择状态
            });
        });

        // 重置选择状态的函数
        function resetSelection() {
            selectedChips = []; // 清空已选择的芯片数组
            const chipElements = document.querySelectorAll(".chip.selected");
            chipElements.forEach(chip => chip.classList.remove("selected")); // 移除所有已选中的样式
        }
    </script>
</body>
</html>
